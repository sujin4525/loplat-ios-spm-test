name: Xcode - Build and Analyze

on:
  workflow_dispatch:
    inputs:
       version:
          description: 'version'     
          required: true

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
        
      - name: Check for existing tag
        run: |
          existing_tag=$(git ls-remote --tags "https://github.com/$GITHUB_REPOSITORY.git" "refs/tags/$VERSION")
          if [[ -n "$existing_tag" ]]; then
            echo "Tag $VERSION already exists. Deleting tag and release..."
            curl -X DELETE -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" "https://api.github.com/repos/$GITHUB_REPOSITORY/releases/tags/$VERSION"
            git push origin --delete "$VERSION"
          fi


